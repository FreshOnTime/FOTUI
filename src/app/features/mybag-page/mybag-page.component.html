<p-scrollPanel [style]="{height: '100vh'}">
  <div class="p-6 max-w-7xl mx-auto bg-gradient-to-r from-gray-50 to-gray-100 shadow-2xl rounded-lg relative">
    <!-- Loading Progress Bar -->
    <div *ngIf="isLoading" class="absolute top-0 left-0 w-full h-1 bg-blue-500 animate-pulse"></div>

    <div class="text-center mb-8">
      <h1 class="text-4xl font-extrabold mb-4 text-gray-900 animate-bounce">Welcome to <span class="text-gray-600">Your Bag</span></h1>
      <p class="text-lg text-gray-700">Manage your orders effortlessly with our <span class="font-semibold text-gray-600">intuitive interface</span>.</p>
      
    </div>

    <!-- Search Bar -->
    <div class="mb-8 flex justify-between items-center">
      <input
        type="text"
        placeholder="Search carts..."
        [(ngModel)]="searchTerm"
        class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      <p-dropdown [options]="sortOptions" [(ngModel)]="selectedSortOption" placeholder="Sort By" class="ml-4"></p-dropdown>
    </div>

    <div class="flex flex-col md:flex-row gap-8">
      <!-- Scheduled Orders -->
      <div class="flex-1">
        <h2 class="text-2xl font-semibold mb-4 text-gray-800 border-b-2 border-gray-300 pb-2">
          <i class="pi pi-calendar mr-2"></i>Scheduled Orders
        </h2>
        <p-scrollPanel [style]="{maxHeight: '400px'}">
          <div class="flex flex-wrap gap-4">
            <div
              *ngFor="let cart of filteredScheduledCarts"
              class="border rounded-lg p-4 cursor-pointer hover:shadow-2xl transition duration-300 bg-white w-full md:w-full"
              (click)="selectCart(cart)"
            >
              <img [src]="cart.picture" alt="{{ cart.name }}" class="w-full h-32 object-cover rounded mb-4">
              <h2 class="text-xl font-semibold text-gray-900">{{ cart.name }}</h2>
              <p class="text-sm text-gray-600">
                Recurring Order (Next: {{ cart.scheduleDate | date:'MMM d, yyyy' }})
              </p>
              <ul class="list-none mt-2">
                <li *ngFor="let item of cart.items" class="flex items-center justify-between bg-gray-100 p-2 rounded mb-1">
                  <span class="text-gray-700">{{ item.name }}</span>
                  <span>{{ item.quantity }} x ${{ item.price }} = ${{ item.quantity * item.price }}</span>
                </li>
              </ul>
              <div class="flex justify-end mt-4 gap-2">
                <button pButton icon="pi pi-pencil" class="p-button-square p-button-secondary" (click)="editCart(cart)" pTooltip="Edit Cart"></button>
                <button pButton icon="pi pi-trash" class="p-button-square p-button-secondary" (click)="confirmDeleteCart(cart)" pTooltip="Delete Cart"></button>
              </div>
            </div>
          </div>
        </p-scrollPanel>
      </div>

      <!-- One-Time Orders -->
      <div class="flex-1">
        <h2 class="text-2xl font-semibold mb-4 text-gray-800 border-b-2 border-gray-300 pb-2">
          <i class="pi pi-shopping-cart mr-2"></i>One-Time Orders
        </h2>
        <p-scrollPanel [style]="{maxHeight: '400px'}">s
          <div class="flex flex-wrap gap-4">
            <div
              *ngFor="let cart of filteredOneTimeCarts"
              class="border rounded-lg p-4 cursor-pointer hover:shadow-2xl transition duration-300 bg-white w-full md:w-full"
              (click)="selectCart(cart)"
            >
              <img [src]="cart.picture" alt="{{ cart.name }}" class="w-full h-32 object-cover rounded mb-4">
              <h2 class="text-xl font-semibold text-gray-900">{{ cart.name }}</h2>
              <p class="text-sm text-gray-600">One-Time Order</p>
              <ul class="list-none mt-2">
                <li *ngFor="let item of cart.items" class="flex items-center justify-between bg-gray-100 p-2 rounded mb-1">
                  <span class="text-gray-700">{{ item.name }}</span>
                  <span>{{ item.quantity }} x ${{ item.price }} = ${{ item.quantity * item.price }}</span>
                </li>
              </ul>
              <div class="flex justify-end mt-4 gap-2">
                <button pButton icon="pi pi-pencil" class="p-button-square p-button-secondary" (click)="editCart(cart)" pTooltip="Edit Cart"></button>
                <button pButton icon="pi pi-trash" class="p-button-square p-button-secondary" (click)="confirmDeleteCart(cart)" pTooltip="Delete Cart"></button>
              </div>
            </div>
          </div>
        </p-scrollPanel>
      </div>
    </div>

    <!-- Selected Cart Details -->
    <div *ngIf="selectedCart" class="mt-8 p-6 border rounded-lg bg-white shadow-2xl">
      <h2 class="text-3xl font-bold text-gray-900">{{ selectedCart.name }}</h2>
      <ul class="list-none mt-4">
        <li *ngFor="let item of selectedCart.items; let i = index" class="flex items-center justify-between bg-gray-100 p-2 rounded mb-1">
          <span class="text-gray-700">{{ item.name }}</span>
          <span>{{ item.quantity }} x ${{ item.price }} = ${{ item.quantity * item.price }}</span>
          <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-secondary p-button-sm" (click)="editItem(i)" pTooltip="Edit Item"></button>
        </li>
      </ul>
      <div *ngIf="editItemIndex !== null" class="mt-4">
        <h3 class="text-xl font-semibold mb-4">Edit Item</h3>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700">Item Name</label>
          <input [(ngModel)]="selectedCart.items[editItemIndex].name" class="border border-gray-300 rounded p-2 w-full mb-2" />
          <label class="block text-sm font-medium text-gray-700">Quantity</label>
          <input type="number" [(ngModel)]="selectedCart.items[editItemIndex].quantity" class="border border-gray-300 rounded p-2 w-full mb-2" />
        </div>
        <div class="flex justify-end gap-2 mt-4">
          <button pButton label="Cancel" icon="pi pi-times" class="p-button-secondary" (click)="cancelEditItem()"></button>
          <button pButton label="Save" icon="pi pi-check" class="p-button-primary" (click)="saveItemEdits()"></button>
          <button pButton label="Confirm" icon="pi pi-check" class="p-button-success" (click)="confirmItemEdits()"></button>
        </div>
      </div>
      <button
        class="bg-gray-500 text-white py-2 px-6 rounded-full mt-6 hover:bg-gray-600 transition duration-300"
        (click)="selectedCart && toggleSchedule(selectedCart)"
      >
        {{ selectedCart.isScheduled ? 'Mark as One-Time' : 'Set as Recurring' }}
      </button>
      <div *ngIf="selectedCart.isScheduled && !editItemIndex" class="mt-4">
        <label for="scheduleDate" class="block text-sm font-medium text-gray-700">
          Schedule Date:
        </label>
        <input
          id="scheduleDate"
          type="date"
          [(ngModel)]="selectedCart.scheduleDate"
          class="border border-gray-300 rounded p-2 mt-1 w-full"
        />
      </div>
    </div>

    <!-- Cart Summary -->
    <div class="mt-8 p-6 border rounded-lg bg-white shadow-2xl">
      <h2 class="text-2xl font-bold text-gray-900">Scheduled Cart Summary</h2>
      <div class="mt-4">
        <p class="text-lg text-gray-700">Total Items: {{ getTotalScheduledItems() }}</p>
        <p class="text-lg text-gray-700">Total Price: ${{ getTotalScheduledPrice() }}</p>
      </div>
    </div>

    <div class="mt-8 p-6 border rounded-lg bg-white shadow-2xl">
      <h2 class="text-2xl font-bold text-gray-900">One-Time Cart Summary</h2>
      <div class="mt-4">
        <p class="text-lg text-gray-700">Total Items: {{ getTotalOneTimeItems() }}</p>
        <p class="text-lg text-gray-700">Total Price: ${{ getTotalOneTimePrice() }}</p>
      </div>
    </div>

 
    <!-- Delete Confirmation Modal -->
    <p-dialog header="Confirm Deletion" [(visible)]="displayDeleteModal" [modal]="true" [closable]="false">
      <p>Are you sure you want to delete this cart?</p>
      <div class="flex justify-end gap-2 mt-4">
        <button pButton label="Cancel" icon="pi pi-times" class="p-button-secondary" (click)="displayDeleteModal=false"></button>
        <button pButton label="Delete" icon="pi pi-check" class="p-button-danger" (click)="deleteCartConfirmed()"></button>
      </div>
    </p-dialog>

    <!-- Notification Toast -->
    <p-toast></p-toast>
  </div>
</p-scrollPanel>
